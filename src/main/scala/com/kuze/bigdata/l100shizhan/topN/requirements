
一.数据准备

本实战项目的数据是采集自电商的用户行为数据.
主要包含用户的 4 种行为: 搜索, 点击, 下单和支付.
数据格式如下, 不同的字段使用下划线分割开_:

                       点击时间         搜索内容
2019-07-17_95_asdacasr1416123f_39_2019-07-17 00:00:00_null_19_20_1_2_3_4_19
2019-07-17_95_bbbbbb12g4t2e112_37_2019-07-17 00:00:02_手机_-1_-1_null_null_null_null_19

以第一条数据说明：
2019-07-17  点击时间
95          用户ID
asdacasr1416123f    sessionID
39  页面ID
2019-07-17 00:00:00 点击详细时间
null  搜索内容，为null表示不是搜索
19  品类ID
20  商品ID
1   下单品类ID
2   下单商品ID
3   支付品类ID
4   支付商品ID
19  城市ID

数据说明:
数据采用_分割字段
每一行表示用户的一个行为, 所以每一行只能是四种行为中的一种.
如果搜索关键字是 null, 表示这次不是搜索
如果点击的品类 id 和产品 id 是 -1 表示这次不是点击
下单行为来说一次可以下单多个产品, 所以品类 id 和产品 id 都是多个, id 之间使用逗号,分割. 如果本次不是下单行为, 则他们相关数据用null来表示
支付行为和下单行为类似.


二.Top10热门品类

简介

品类是指的产品的的分类, 一些电商品类分多级, 咱们的项目中品类类只有一级. 不同的公司可能对热门的定义不一样. 我们按照每个品类的 点击、下单、支付 的量来统计热门品类.

思路 1
分别统计每个品类 点击的次数，下单的次数和支付的次数.
缺点: 统计 3 次, 需要启动 3 个 job, 每个 job 都有对原始数据遍历一次, 非常的耗时

思路 2
最好的办法应该是遍历一次能够计算出来上述的 3 个指标.
使用累加器可以达成我们的需求.
遍历全部日志数据, 根据品类 id 和操作类型分别累加. 需要用到累加器

定义累加器
当碰到订单和支付业务的时候注意拆分字段才能得到品类 id
遍历完成之后就得到每个每个品类 id 和操作类型的数量.
按照点击下单支付的顺序来排序
取出 Top10